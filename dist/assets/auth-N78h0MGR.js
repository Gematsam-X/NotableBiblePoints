import{B as e}from"./index-C1EFNDRC.js";import{s as a,h as o}from"./loadingGif-CLxvH4cC.js";import{t as r}from"./toast-BIaIkxlU.js";const t=document.getElementById("signIn"),i=document.getElementById("signUp");t&&t.addEventListener("click",(t=>{t.preventDefault();!async function(t,i){if(t&&i){a();try{const a=await e.UserService.login(t,i,!0);console.log("Utente loggato:",a),localStorage.setItem("userEmail",a.email),localStorage.setItem("userToken",a["user-token"]),window.location.href="../index.html"}catch(n){console.error("Errore nel login:",n);const e=n.message.toLowerCase();e.includes("invalid login or password")?r("Credenziali errate o utente non registrato. Controlla l'email e la password, verifica di essere registrato e riprova."):e.includes("password value cannot be empty")?r("Inserisci la password.",2e3):e.includes("email value cannot be empty")?r("Inserisci l'email.",2e3):e.includes("email address must be confirmed first")?r("Conferma il tuo indirizzo email prima di accedere. Puoi farlo accedendo alla tua posta elettronica e cliccando sul link contenuto nella mail da parte di Backendless.",5e3):e.includes("network error")||e.includes("failed to fetch")?r("Errore di connessione. Controlla la tua rete e riprova."):r(n.message)}finally{o()}}else r("Inserisci sia l'email che la password.")}(document.getElementById("email").value.trim(),document.getElementById("password").value.trim())})),i&&i.addEventListener("click",(t=>{t.preventDefault();!async function(t,i){if(i.length<6)return void r("La password deve contenere almeno 6 caratteri.");console.log("Lunghezza password valida:",i.length),a();const n=new e.User;n.email=t.toLowerCase().trim(),n.password=i,n.name=t.toLowerCase().trim();try{const a=await e.UserService.register(n);console.log("Utente registrato:",a),r("Registrazione riuscita! Controlla la tua email per la conferma.")}catch(s){console.error("Errore durante la registrazione:",s);const e=s.message.toLowerCase();e.includes("already exists")?r("L'utente è già registrato. Prova ad effettuare il login."):e.includes("session timeout")?r("Sessione scaduta. Riprova dopo aver riavviato l'app."):e.includes("network error")||e.includes("failed to fetch")?r("Errore di connessione. Controlla la tua rete e riprova."):e.includes("provided email has wrong format")?r("Inserisci un'email valida."):r(s.message)}finally{o()}}(document.getElementById("newEmail").value.trim(),document.getElementById("newPassword").value.trim())}));
