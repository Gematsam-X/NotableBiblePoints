import{hideGif as e,showGif as a}from"./loadingGif.js";import o from"./toast.js";const r=document.getElementById("signIn"),t=document.getElementById("signUp");r&&r.addEventListener("click",(r=>{r.preventDefault();!async function(r,t){if(r&&t){a();try{const e=await Backendless.UserService.login(r,t,!0);console.log("Utente loggato:",e),localStorage.setItem("userEmail",e.email),localStorage.setItem("userToken",e["user-token"]),window.location.href="main.html"}catch(e){console.error("Errore nel login:",e);const a=e.message.toLowerCase();a.includes("invalid login or password")?o("Credenziali errate o utente non registrato. Controlla l'email e la password, verifica di essere registrato e riprova."):a.includes("password value cannot be empty")?o("Inserisci la password.",2e3):a.includes("email value cannot be empty")?o("Inserisci l'email.",2e3):a.includes("email address must be confirmed first")?o("Conferma il tuo indirizzo email prima di accedere. Puoi farlo accedendo alla tua posta elettronica e cliccando sul link contenuto nella mail da parte di Backendless.",5e3):a.includes("network error")||a.includes("failed to fetch")?o("Errore di connessione. Controlla la tua rete e riprova."):o(e.message)}finally{e()}}else o("Inserisci sia l'email che la password.")}(document.getElementById("email").value.trim(),document.getElementById("password").value.trim())})),t&&t.addEventListener("click",(r=>{r.preventDefault();!async function(r,t){if(t.length<6)return void o("La password deve contenere almeno 6 caratteri.");console.log("Lunghezza password valida:",t.length),a();const n=new Backendless.User;n.email=r.toLowerCase().trim(),n.password=t,n.name=r.toLowerCase().trim();try{const e=await Backendless.UserService.register(n);console.log("Utente registrato:",e),o("Registrazione riuscita! Controlla la tua email per la conferma.")}catch(e){console.error("Errore durante la registrazione:",e);const a=e.message.toLowerCase();a.includes("already exists")?o("L'utente è già registrato. Prova ad effettuare il login."):a.includes("session timeout")?o("Sessione scaduta. Riprova dopo aver riavviato l'app."):a.includes("network error")||a.includes("failed to fetch")?o("Errore di connessione. Controlla la tua rete e riprova."):a.includes("provided email has wrong format")?o("Inserisci un'email valida."):o(e.message)}finally{e()}}(document.getElementById("newEmail").value.trim(),document.getElementById("newPassword").value.trim())}));