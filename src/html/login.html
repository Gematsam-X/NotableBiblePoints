<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Login - NotableBiblePoints</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="/src/assets/favicon.ico" />
    <script type="module">
      if (window.location.hostname.includes("github.io"))
        window.location.href =
          "https://notablebiblepoints.netlify.app/index.html";
    </script>
    <script type="module">
      if (localStorage.getItem("isAuthenticated") == "true") {
        window.location.href = "/index.html";
      }
    </script>
    <!-- Meta tag Open Graph -->
    <meta property="og:title" content="Login - NotableBiblePoints" />
    <meta
      property="og:description"
      content="NotableBiblePoints permette di salvare i punti notevoli della Bibbia e di sincronizzarli tra i vari dispositivi."
    />
    <meta
      property="og:image"
      content="https://notablebiblepoints.netlify.app/src/assets/favicon.ico"
    />
    <meta property="og:url" content="https://notablebiblepoints.netlify.app" />
    <meta property="og:type" content="website" />
  </head>
  <button class="help">
    <img width="40px" height="40px" id="help_img" />
  </button>
  <body class="centered-body login-form">
    <h1><span id="keyword">Accedi a</span> NotableBiblePoints</h1>

    <div class="container">
      <!-- Link per cambiare sezione -->
      <div class="nav">
        <a id="loginTab" class="active">Accedi</a>
        <a id="signupTab">Registrati</a>
      </div>

      <!-- Modulo Login -->
      <form id="loginForm" class="form-container active">
        <label for="email">Email</label>
        <input type="text" id="email" name="email" />
        <label for="password">Password</label>
        <div class="password-wrapper">
          <input type="password" id="password" name="password" />
          <i class="fi-sr-eye" id="loginPwdVisible"></i>
        </div>
        <button type="submit" id="signIn">Accedi</button>
        <br />
        <br />
        <br />
        <br />
        <ins id="recovery">Hai dimenticato la password? Clicca qui.</ins>
      </form>

      <!-- Modulo Signup -->
      <form id="signupForm" class="form-container">
        <label for="newEmail">Email</label>
        <input type="text" id="newEmail" name="newEmail" />
        <label for="newPassword">Password</label>
        <div class="password-wrapper">
          <input type="password" id="newPassword" name="newPassword" />
          <i class="fi-sr-eye" id="signupPwdVisible"></i>
        </div>
        <button type="submit" id="signUp">Registrati</button>
      </form>
    </div>

    <div class="modal centeredModal">
      <div class="modal-content">
        <div class="modal-header">
          <span class="closeModal">&times;</span>
          <h2>Recupera la tua password</h2>
        </div>
        <hr />
        <div class="modal-body">
          <form>
            <label for="emailForRecovery">La tua email di registrazione</label>
            <input type="email" id="emailForRecovery" />
            <button type="submit" id="recoveryBtn">Avanti</button>
          </form>
        </div>
        <hr />
        <div class="modal-footer">
          <h3>NotableBiblePoints - Salva i punti notevoli</h3>
        </div>
      </div>
    </div>

    <script type="module" src="/src/js/auth.js"></script>
    <script type="module" src="/src/js/rememberMe.js"></script>
    <script type="module" src="/src/js/loadingGif.js"></script>
    <script type="module" src="/src/js/theme.js"></script>
    <script type="module" src="/src/js/toggleLoginSignup.js"></script>
    <script type="module" src="/src/js/recovery.js"></script>
    <script type="module" src="/src/js/legend.js"></script>
    <script type="module">
      import checkVersion from "/src/js/checkVersion.js";
      checkVersion();
    </script>
    <script type="module">
      document
        .querySelector(".help")
        .addEventListener(
          "click",
          () => (window.location.href = "/src/html/onboarding.html")
        );
    </script>
    <script type="module">
      import { logoutUser } from "/src/js/logoutAndDelete.js";
      const versionToFloat = (s) =>
        parseFloat(s.split(".").shift() + "." + s.split(".").slice(1).join(""));
      if (versionToFloat(localStorage.getItem("appVersion")) < 2.31) {
        const selectedTheme = localStorage.getItem("theme");
        localStorage.clear();
        localStorage.setItem("theme", selectedTheme);
        localStorage.setItem("appVersion", "2.3.1");
        await logoutUser(false);
      }
    </script>
  </body>
</html>
